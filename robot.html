<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="anyag.css" title="normal">
    <!--<link rel="alternate stylesheet" type="text/css" href="nagybetus.css" title="nagybetus">-->
    <link rel="icon" type="image" href="k√©pek/favicon-curly-bracket.png">
    <title>Robotlabirintus - Webes j√°t√©kok szakk√∂r</title>
</head>
<body>
    <header>
        <ul>
            <li><a href="index.html">Kezd≈ëlap</a></li>
            <li>Forr√°sok</li>
            <li>√ìrav√°zlatok</li>
            <li>R√≥lunk</li>
        </ul>
    </header>

    <main>
        <div class="cim">
            <div>
                <p><span></span>Szakk√∂ri seg√©danyag</p>
                <h1>Robotlabirintus ü§ñ</h1>
            </div>
        </div>
        
        <div class="anyag">
            <h2>√Åttekint√©s</h2>

            <div class="informacio-ido">
                <figure>
                    <img src="k√©pek/√≥ra.png">
                </figure>
                <p>45'</p>
            </div>
            <div class="informacio-szint">
                <figure>
                    <img src="k√©pek/csillag.png">
                </figure>
                <p>k√∂nny≈±</p>
            </div>

            <h3>A j√°t√©k c√©lja</h3>
            <p>A j√°t√©k l√©nyege, hogy a <b>ny√≠l</b> billenty≈±k seg√≠ts√©g√©vel <b>kijussunk</b> a Robottal a labirintusb√≥l. Viszont ebben a labirintusban nem falakkal, hanem <b>v√≠z</b>zel üåä vagyunk k√∂r√ºlv√©ve, vagyis ha belees√ºnk, akkor <b>v√©ge</b> a j√°t√©knak. A k√ºldet√©st megnehez√≠ti, hogy az ir√°nyok <b>fel lettek cser√©lve</b>... Vajon <b>h√°ny m√°sodperc</b> ‚åõ alatt siker√ºl teljes√≠tened a k√ºldet√©st? Hajr√°!</p>
            
            <a href="../13 Robotlabirintus/index.html">
                <div class="megtekintes-gomb">
                    <p>Interakt√≠v p√©lda</p>
                </div>
            </a>

        </div>

        <div class="utmutato">
            <h2>√ötmutat√≥</h2>

            <p>Az √∫tmutat√≥ a <a href="https://code.visualstudio.com/" target="_blank">Visual Studio Code</a> fejleszt≈ëi k√∂rnyezethez k√©sz√ºlt.</p>

            <h3>N√©gyzetr√°csalap√∫ j√°t√©kok</h3>

            <p>A sz√°m√≠t√≥g√©pes j√°t√©kok egy csoportja a <b>n√©gyzetr√°csalap√∫ j√°t√©kok</b> (grid-based games). Ezekben a j√°t√©kokban a j√°t√©kt√©r n√©gyzetr√°csokra van felosztva, √©s minden szerepl≈ë csak ezeken a n√©gyzetr√°csokon, m√°s sz√≥val <b>mez≈ë</b>k√∂n tud mozogni. Pontosabban mez≈ëk√∂z√©ppontok k√∂z√∂tt mozog. Ide tartoznak - t√∂bbek k√∂z√∂tt - az al√°bbi j√°t√©kok:</p>

            <ul>
                <li>Sakk</li>
                <li>Aknakeres≈ë</li>
                <li>Pac-Man</li>
                <li>The Legend of Zelda (korai verzi√≥k)</li>
                <li>Fire Emblem</li>
                <li>Labyrinth t√°rsasj√°t√©k</li>
            </ul>

            <div class="kepsor">
                <figure>
                    <img src="k√©pek/fire-emblem.png">
                    <figcaption>Fire Emblem</figcaption>
                </figure>
                <figure>
                    <img src="k√©pek/labirintus-tarsasjatek.jpg">
                    <figcaption>Labyrinth t√°rsasj√°t√©k</figcaption>
                </figure>
                <figure>
                    <img src="k√©pek/zelda_a_zold_sapkas_fiu_kalandjai_4.jpg">
                    <figcaption>The Legend of Zelda</figcaption>
                </figure>
            </div>

            <div class="kepsor">
                <figure>
                    <img src="k√©pek/pac-man.jpg">
                    <figcaption>Pac-Man</figcaption>
                </figure>
                <figure>
                    <img src="k√©pek/aknakereso.png">
                    <figcaption>Aknakeres≈ë</figcaption>
                </figure>
            </div>

            <p>Ebben a projektben elk√©sz√≠tj√ºk az <b>els≈ë n√©gyzetr√°csalap√∫ j√°t√©kunkat</b>.</p>
            
            <h3>HTML</h3>

            <p>Induljunk ki a m√°r j√≥l ismert alapstrukt√∫r√°b√≥l. A canvas sz√©less√©g√©t √©s magass√°g√°t √∫gy hat√°rozzuk meg, hogy egy <b>360 px</b> sz√©les √©s <b>320 px</b> magas j√°t√©kteret kapjunk! Az√©rt ekkor√°t, mert a n√©gyzetr√°csok alapja egy 40x40 px-es n√©gyzet lesz. Ebb≈ël m√°r l√°that√≥, hogy a mi j√°t√©kunk egy 9x8-as n√©gyzetr√°cs lesz.</p>

            <pre>
                <code>
&lt;!DOCTYPE html&gt;
&lt;html lang="<span class="kodkiemeles">hu</span>"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;title&gt;<span class="kodkiemeles">Robotlabirintus</span>&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;<span class="kodkiemeles">Robotlabirintus</span>&lt;/h1&gt;
    &lt;canvas width="<span class="kodkiemeles">360</span>" height="<span class="kodkiemeles">320</span>"&gt;&lt;/canvas&gt;
    &lt;script src="index.js"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
                </code>
            </pre>
            
            <h3>JavaScript</h3>

            <p>Induljunk ki az al√°bbi JavaScript k√≥db√≥l.</p>

            <pre>
                <code>
const canvas = document.querySelector('canvas');
const ctx = canvas.getContext('2d');

/* === √ÅLLAPOTT√âR === */

/*P√°lya t√°rol√°sa*/


/*Konstansok*/
// mez≈ëm√©ret

let robotk√©p = new Image();
robotk√©p.src = 'robot.png';

/*V√°ltoz√≥k*/
// robot


// egy√©b v√°ltoz√≥k

let vesztett√©l = false;
let nyert√©l = false;



/* === ANIM√ÅCI√ìS CIKLUS === */


k√∂vetkez≈ë(); // az anim√°ci√≥ elind√≠t√°sa

function k√∂vetkez≈ë() {
    id≈ë = performance.now();
    friss√≠t√©s(id≈ë); // √°llapott√©r friss√≠t√©se
    rajzol√°s(); // k√©pkocka √∫jrarajzol√°sa
    requestAnimationFrame(k√∂vetkez≈ë);
}

function rajzol√°s() {
    // h√°tt√©r
    ctx.fillStyle = 'orange';
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // vizek
    

    // robot
    
    
    // nyertes sz√∂veg
    if(nyert√©l) {
        ctx.font = '80px Arial';
        ctx.fillStyle = 'black';
        ctx.fillText('Nyert√©l', 50, 170);
    }

    // v√≠zbe es√©s
    if(vesztett√©l) {
        ctx.font = '40px Arial';
        ctx.fillStyle = 'black';
        ctx.fillText('üåäV√≠zbe est√©lüåä', 30, 170);
    }

    // id≈ë
    ctx.font = '20px Arial';
    ctx.fillStyle = 'black';
    ctx.fillText('‚åõ: ...', 10, 30);
}

function friss√≠t√©s(dt) {
    // Billenty≈±k figyel√©se
    

    // robot cs√∫sztat√°sa
    

    // c√©lba √©r√©s
    
}

/* === ESEM√âNYEK === */

// lenyomott billenty≈±k elt√°rol√°sa
document.addEventListener('keydown', e => {
    billenty≈±k[e.key] = true;
})

document.addEventListener('keyup', e => {
    billenty≈±k[e.key] = false;
})
                </code>
            </pre>

            <h4>A p√°lya kirajzol√°sa</h4>

            <p>A p√°lya n√©gyzetr√°csait √©rdemes kis mez≈ëkk√©nt elk√©pzelni, amit valamilyen minta alapj√°n fogunk kirajzolni. A p√°lya alapj√°ul egy narancss√°rga h√°tt√©r fog szolg√°lni, amire elhelyezz√ºk a v√≠z mez≈ëket √©s a robotot. Ezeket a mez≈ëket azonos√≠ts√°k a <span class="kodreszlet">V</span> (v√≠z) √©s <span class="kodreszlet">R</span> (robot) bet≈±k.</p>

            <div class="kepsor">
                <figure>
                    <img src="k√©pek/robot-negyzetracs-betukkel-azon.png">
                    <figcaption>Bet≈±kkel azonos√≠tott mez≈ëk</figcaption>
                </figure>
            </div>

            <p>Soronk√©nt n√©zve alkossunk sz√∂veget a p√°ly√°b√≥l √∫gy, hogy a bet≈±ket tartalmaz√≥ mez≈ëket a benne l√©v≈ë bet≈±vel √≠rjuk le, az √ºreseket pedig sz√≥k√∂zzel. √çgy az els≈ë sor <span class="kodreszlet">"VVVVVVV_V"</span>, a m√°sodik sor <span class="kodreszlet">"V_______V"</span> √©s √≠gy tov√°bb. A sz√∂vegek abban hasonl√≠tanak a t√∂mb√∂kre, hogy minden karakter√©nek van indexe. Vagyis az els≈ë sort le√≠r√≥ sz√∂veg 2. index√©n <span class="kodreszlet">V</span> van, m√≠g a m√°sodik sor 7. index√©n <span class="kodreszlet">_</span> (sz√≥k√∂z) van. Ennek k√∂sz√∂nhet≈ëen minden mez≈ët be tudunk azonos√≠tani egy <b>sor-index</b> sz√°mp√°rral. Annak √©rdek√©ben, hogy a soroknak is legyen a k√≥dban sorsz√°ma, t√°roljuk el a sorokat le√≠r√≥ sz√∂vegeket egy t√∂mbben. √çgy az el≈ëbbi sz√°mp√°r <b>t√∂mbelem-t√∂mbelemindex</b>re m√≥dosul.</p>

            <pre>
                <code>
/*P√°lya t√°rol√°sa*/
<span class="kodkiemeles">let p√°lya = [
    "VVVVVVV V",
    "V       V",
    "V VV VV V",
    "VVV     V",
    "V   V V V",
    "V VV  V V",
    "VRV   V V",
    "VVVVVVVVV"
];</span>
                </code>
            </pre>

            <p class="feladat"><b>‚úÖFeladat</b><br>Gyakorl√°sk√©nt √≠rjuk ki a console-ra a <span class="kodreszlet">p√°lya</span> t√∂mb 4. indexen l√©v≈ë elem√©t!</p>

            <details>
                <summary>Megold√°s</summary>
                <pre>
                    <code>
console.log(p√°lya[4]);
                    </code>
                </pre>

                <div class="kepsor">
                    <figure>
                        <img src="k√©pek/robot-palya-negyedik-sora-kiir-consolera.png">
                        <figcaption>A <span class="kodreszlet">p√°lya</span> 4. index≈± eleme a p√°lya 5. sora. A hiba√ºzenettel k√©s≈ëbb foglalkozunk.</figcaption>
                    </figure>
                </div>

            </details>

            <p class="feladat"><b>‚úÖFeladat</b><br>Most √≠rjuk ki a console-ra a <span class="kodreszlet">p√°lya</span> t√∂mb 7. sor√°nak 2. karakter√©t!</p>

            <details>
                <summary>Megold√°s</summary>

                <p>Ezt √∫gy tehetj√ºk meg, hogy a t√∂mb neve ut√°n k√©t <span class="kodreszlet">[ ][ ]</span> jelet tesz√ºnk. Az els≈ëbe √≠rt sz√°m a t√∂mbindexet jelenti, a m√°sodik pedig az adott sz√∂veg (t√∂mbelem) adott index≈± karakter√©t.</p>

                <pre>
                    <code>
console.log(p√°lya[4]);
<span class="kodkiemeles">console.log(p√°lya[6][1]);</span>
                    </code>
                </pre>

                <div class="kepsor">
                    <figure>
                        <img src="k√©pek/robot-palya-hetedik-sor-masodik-karakter-kiir-consolera.png">
                        <figcaption>A ki√≠rt <span class="kodreszlet">R</span> bet≈± jelenti, hogy itt helyezkedik el a robot.</figcaption>
                    </figure>
                </div>

            </details>

            <p>A mint√°nk rendelkez√©sre √°ll, √©s m√°r azt is tudjuk, hogyan √©rhetj√ºk el az egyes elemeket, vagyis le tudjuk k√©rdezni, hogy az adott mez≈ëre mi ker√ºl. Persze nem szeretn√©nk minden mez≈ët egyenk√©nt lek√©rdezni, ez√©rt √≠rjunk egy programot a p√°lya sorfolytonos bej√°r√°s√°ra. A sorfolytonoss√°g azt jelenti, hogy fentr≈ël lefel√©, balr√≥l jobbra haladva megn√©zz√ºk a mint√°t (teh√°t a <span class="kodreszlet">p√°lya</span> t√∂mb√∂t), √©s minden karakter vizsg√°latakor eld√∂ntj√ºk, hogy kell-e oda tenni valamit (vizet vagy robotot). Erre fogjuk haszn√°lni a <b>sz√°ml√°l√≥s ciklus</b>t, vagy ahogyan sokan nevezik, a <span class="kodreszlet">for</span> ciklust.</p>

            <div class="megjegyzes">
                <p><b>üí≠Megjegyz√©s</b></p>
                <h4>Sz√°ml√°l√≥s ciklus</h4>

                <p>Mit jelent a <b>ciklus</b> sz√≥? A programoz√°sban a ciklus vagy iter√°ci√≥ <b>ism√©tl√©st</b> jelent, vagyis ism√©tl≈ëd≈ë feladatok megval√≥s√≠t√°s√°ra szolg√°l. A sz√°ml√°l√≥s ciklus szerkezete a JavaScriptben az al√°bbi:</p>

                <pre>
                    <code>
<span class="kodkiemeles">for (let i = 0; i &lt; 10; i++) {</span>
    console.log(i);
<span class="kodkiemeles">}</span>
                    </code>
                </pre>

                <p>A sz√°ml√°l√≥s ciklust a <span class="kodreszlet">for</span> kulcssz√≥val kezdj√ºk, mely ut√°n z√°r√≥jelben megadunk h√°rom param√©tert:</p>

                <ol>
                    <li>Mett≈ël megy a ciklus. Itt defini√°ljuk (l√©trehozzuk) a ciklusv√°ltoz√≥t, ami sok esetben az <span class="kodreszlet">i</span> nevet kapja. <b>A p√©ld√°ban 0-t√≥l megy a ciklus.</b></li>
                    <li>Meddig menjen a ciklus. <b>A p√©ld√°ban 10-ig megy a ciklus.</b></li>
                    <li>H√°nyas√°val menjen a ciklus. <b>A p√©ld√°ban egyes√©vel l√©p a ciklus.</b></li>
                </ol>

                <p>Ezut√°n <span class="kodreszlet">{ }</span> jelek k√∂z√∂tt megfogalmazzuk azt (azokat) a parancsot (parancsokat), amit minden ciklusl√©p√©sben v√©gre kell hajtani. <b>A p√©ld√°ban ki√≠rjuk a ciklusv√°ltoz√≥t (<span class="kodreszlet">i</span>).</b></p>

                <p>A fenti p√©lda eredm√©nye a console-on:</p>

                <div class="kepsor">
                    <figure>
                        <img src="k√©pek/robot-szamlalos-ciklus.png">
                        <figcaption>Az <span class="kodreszlet">i</span> ciklusv√°ltoz√≥ √©rt√©ke 10 ciklusl√©p√©sen (iter√°ci√≥n) kereszt√ºl.</figcaption>
                    </figure>
                </div>

                <p>A ciklusokat egym√°sba is lehet √©p√≠teni. Ebben az esetben fontos, hogy a ciklusv√°ltoz√≥knak k√ºl√∂nb√∂z≈ë nevet adjunk.</p>

                <pre>
                    <code>
<span class="kodkiemeles">for</span> (let i = 0; i &lt; 10; i++) {
    <span class="kodkiemeles">for</span> (let <span class="kodkiemeles">j</span> = 0; <span class="kodkiemeles">j</span> &lt; 3; <span class="kodkiemeles">j</span>++) {
        console.log(<span class="kodkiemeles">j</span>);
    }
}
                    </code>
                </pre>

                <p>A fenti k√≥dban a bels≈ë ciklus 0-t√≥l 2-ig √≠rja ki a sz√°mokat. Mindezt 10-szer teszi meg a k√ºls≈ë ciklus miatt.</p>

                <div class="kepsor">
                    <figure>
                        <img src="k√©pek/robot-szamlalos-ciklus-egymasba-agyazott.png">
                        <figcaption>Az egym√°sba √°gyazott ciklus eredm√©ny√©nek r√©szlete</figcaption>
                    </figure>
                </div>

                <p><b>Erre az egym√°sba √°gyazott ciklusra lesz sz√ºks√©g√ºnk nek√ºnk is, mert nemcsak a sorokon (t√∂mb√∂n) kell v√©gigmenn√ºnk, hanem az oszlopokon (t√∂mbelemeken) is.</b></p>
            </div>

            <p>A sor az <span class="kodreszlet">y</span> poz√≠ci√≥t hat√°rozza meg, az oszlop pedig az <span class="kodreszlet">x</span>-et, ez√©rt nevezz√ºk el √≠gy a ciklusv√°ltoz√≥kat. A k√ºls≈ë ciklus a t√∂mb hossz√°ig menjen, a bels≈ë pedig a sor hossz√°ig.</p>

            <pre>
                <code>
// a p√°lya t√∂mb bej√°r√°sa sorfolytonosan
<span class="kodkiemeles">for (let y = 0; y &lt; p√°lya.length; y++) {
    for (let x = 0; x &lt; p√°lya[y].length; x++) {</span>
        ...
    <span class="kodkiemeles">}
}</span>
                </code>
            </pre>

            <p>A p√°lyaminta alapj√°n a robotnak √©s minden v√≠znek be kell √°ll√≠tanunk az <span class="kodreszlet">x</span> √©s <span class="kodreszlet">y</span> poz√≠ci√≥j√°t. Robotb√≥l csak egy van, v√≠zb≈ël viszont sok, ez√©rt a vizeket egy t√∂mbben fogjuk t√°rolni. Hozzuk l√©tre az <span class="kodreszlet">M</span> konstanst, a <span class="kodreszlet">robot</span> objektumot √©s a <span class="kodreszlet">vizek</span> t√∂mb√∂t. √Åll√≠tsuk be a robot tulajdons√°gait √©s t√∂lts√ºk fel a t√∂mb√∂t.</p>

            <pre>
                <code>
/*Konstansok*/
// mez≈ëm√©ret
<span class="kodkiemeles">const M = 40;</span>

let robotk√©p = new Image();
robotk√©p.src = 'robot.png';

/*V√°ltoz√≥k*/
// robot
<span class="kodkiemeles">let robot = {
    x: 0,
    y: 0,
    sz√©less√©g: M,
    magass√°g: M
}</span>

// egy√©b v√°ltoz√≥k
<span class="kodkiemeles">let vizek = [];</span>

// a p√°lya t√∂mb bej√°r√°sa sorfolytonosan
for (let y = 0; y &lt; p√°lya.length; y++) {
    for (let x = 0; x &lt; p√°lya[y].length; x++) {
        <span class="kodkiemeles">switch (p√°lya[y][x]) {
            case "V":
                vizek.push({ x: x, y: y, sz√©less√©g: M, magass√°g: M })
                break;
            case "R":
                robot.x = x;
                robot.y = y;
                break;
        }</span>
    }    
}
                </code>
            </pre>

            <p>A fenti k√≥dban a <span class="kodreszlet">switch</span> egy olyan el√°gaz√°s, melynek sz√°mtalan esete lehet a m√∂g√∂tte z√°r√≥jelben megfogalmazott felt√©tel alapj√°n. Mi most kett≈ët kezel√ºnk: att√≥l f√ºgg≈ëen, hogy az √©ppen vizsg√°lt elem (<span class="kodreszlet">p√°lya[y][x]</span>) <span class="kodreszlet">"V"</span> vagy <span class="kodreszlet">"R"</span>,</p>

            <ul>
                <li>hozz√°f≈±zz√ºk a vizet a <span class="kodreszlet">vizek</span> t√∂mbh√∂z elt√°rolva r√≥la, hogy hanyadik mez≈ëben lesz a v√≠z v√≠zszintesen (<span class="kodreszlet">x</span>) √©s f√ºgg≈ëlegesen (<span class="kodreszlet">y</span>), valamint hogy mekkora a <span class="kodreszlet">sz√©less√©g</span>e √©s <span class="kodreszlet">magass√°g</span>a, vagy</li>
                <li>be√°ll√≠tjuk, hogy a <span class="kodreszlet">robot</span> melyik mez≈ëb≈ël indul.</li>
            </ul>

            <p>A <span class="kodreszlet">break</span> az eset lez√°r√°s√°ra szolg√°l√≥ k√∂telez≈ë elem.</p>

            <p><b>Most m√°r minden szerepl≈ër≈ël tudjuk, hogy melyik mez≈ën helyezkedik el.</b> P√©ld√°ul a vizek t√∂mb 13. indexen l√©v≈ë elem√©nek (jel√∂lve az al√°bbi rajzon) tulajdons√°gai:</p>

            <ul>
                <li><span class="kodreszlet">x</span>: 5</li>
                <li><span class="kodreszlet">y</span>: 2</li>
                <li><span class="kodreszlet">sz√©less√©g</span>: 40</li>
                <li><span class="kodreszlet">magass√°g</span>: 40</li>
            </ul>

            <div class="kepsor">
                <figure>
                    <img src="k√©pek/robot-negyzetracs-vizek-13-adatok.png">
                    <figcaption>A <span class="kodreszlet">vizek</span> t√∂mb 13. elem√©nek tulajdons√°gai.</figcaption>
                </figure>
                <figure>
                    <img src="k√©pek/robot-vizek-13.png">
                    <figcaption>A <span class="kodreszlet">vizek</span> t√∂mb 13. elem√©nek tulajdons√°gai.</figcaption>
                </figure>
            </div>

            <p>A <b>kirajzol√°s</b>n√°l √©szben kell tartanunk, hogy a vizek √©s a <span class="kodreszlet">robot</span> <span class="kodreszlet">x</span> √©s <span class="kodreszlet">y</span> tulajdons√°g√°t m√©g meg kell szoroznunk <span class="kodreszlet">M</span>-mel, hogy t√©nyleg a megfelel≈ë pixelt≈ël kezd≈ëd≈ëen legyenek kirajzolva. Rajzoljunk a vizek hely√©re k√©k n√©gyzetet, a robot hely√©re pedig a <span class="kodreszlet">robotk√©p</span>et!</p>

            <div class="megjegyzes">
                <p><b>üí≠Megjegyz√©s</b><br>A <span class="kodreszlet">forEach</span> vez√©rl√©si szerkezet automatikusan v√©gigmegy a megadott t√∂mb√∂n. A sz√°ml√°l√≥s ciklussal ellent√©tben itt nem kell gondoskodni a ciklusv√°ltoz√≥ l√©ptet√©s√©r≈ël. Form√°ja: <span class="kodreszlet"><i>t√∂mb</i>.forEach(<i>t√∂mbelem</i> => { <i>mitTegy√ºnkAzAdottElemmel</i>; });</span>. A mi eset√ºnkben: <span class="kodreszlet">vizek.forEach(v√≠z => { <i>kirajzol√°s</i>; });</span>. Ez azt jelenti, hogy minden k√©perny≈ëfriss√≠t√©sn√©l v√©gigmegy a vizek t√∂mb <b>√∂sszes</b> elem√©n, √©s beleteszi az adott elemet a <span class="kodreszlet">v√≠z</span> v√°ltoz√≥ba. Az ezt k√∂vet≈ë <span class="kodreszlet">=></span> jel ut√°n <span class="kodreszlet">{ }</span> jelek k√∂z√∂tt adjuk meg, hogy mit csin√°lunk az adott elemmel. Jelen esetben kirajzoljuk azt. A kirajzol√°sn√°l a <span class="kodreszlet">v√≠z</span> objektumra hivatkozunk, mert ez az aktu√°lis v√≠z elem, amit ki kell rajzolnunk. A t√∂mbbej√°r√°s ezen form√°j√°r√≥l b≈ëvebben a <a href="https://www.w3schools.com/jsref/jsref_forEach.asp" target="_blank">w3schools.com</a> oldalon olvashatsz.</p>
            </div>

            <pre>
                <code>
function rajzol√°s() {
    // h√°tt√©r
    ctx.fillStyle = 'orange';
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // vizek
    <span class="kodkiemeles">ctx.fillStyle = 'lightblue';
    vizek.forEach(v√≠z => {
        ctx.fillRect(v√≠z.x * M, v√≠z.y * M, v√≠z.sz√©less√©g, v√≠z.magass√°g);
    });</span>

    // robot
    <span class="kodkiemeles">ctx.drawImage(robotk√©p, robot.x * M, robot.y * M, robot.sz√©less√©g, robot.magass√°g);</span>
    
    // nyertes sz√∂veg
    if(nyert√©l) {
        ctx.font = '80px Arial';
        ctx.fillStyle = 'black';
        ctx.fillText('Nyert√©l', 50, 170);
    }

    // v√≠zbe es√©s
    if(vesztett√©l) {
        ctx.font = '40px Arial';
        ctx.fillStyle = 'black';
        ctx.fillText('üåäV√≠zbe est√©lüåä', 30, 170);
    }

    // id≈ë
    ctx.font = '20px Arial';
    ctx.fillStyle = 'black';
    ctx.fillText('‚åõ: ...', 10, 30);
}
                </code>
            </pre>

            <div class="kepsor">
                <figure>
                    <img src="k√©pek/robot-vizek-es-robot-kirajzolas.png">
                    <figcaption>A vizek √©s a <span class="kodreszlet">robot</span> kirajzol√°sa</figcaption>
                </figure>
            </div>

            <h4>A robot ir√°ny√≠t√°sa</h4>

            <p>Most, hogy minden kirajzol√°sra ker√ºlt, k√©sz√≠ts√ºk el a <span class="kodreszlet">robot</span> <b>n√©gyir√°ny√∫</b> mozg√°s√°t, mely a <b>ny√≠l billenty≈±kre</b> t√∂rt√©njen.</p>

            <p>Mint azt a tananyag elej√©n olvashatjuk, a n√©gyzetr√°csalap√∫ j√°t√©kokban a szerepl≈ëk csak n√©gyzetr√°csr√≥l n√©gyzetr√°csra tudnak mozogni, √©s egyszerre csak egy mez≈ët tudnak l√©pni a n√©gy ir√°ny valamelyik√©ben. Tapasztalataink alapj√°n azt is meg√°llap√≠thatjuk, hogy a mozg√°s val√≥ban mozg√°s √©s nem teleport√°l√°s, vagyis nem el√©g √°t√≠rnunk a <span class="kodreszlet">robot</span> <span class="kodreszlet">x</span> √©s <span class="kodreszlet">y</span> poz√≠ci√≥j√°t, hanem a k√©t mez≈ë k√∂z√∂tt t√∂bbsz√∂r ki kell rajzolnunk azt.</p>

            <div class="kepsor">
                <figure>
                    <img src="k√©pek/robot-mozgas.gif">
                    <figcaption>A <span class="kodreszlet">robot</span>ot a k√©t mez≈ë k√∂z√∂tt folyamatosan kirajzoljuk, nem teleport√°l</figcaption>
                </figure>
            </div>

            <p>A billenty≈±k figyel√©s√©re √©s elt√°rol√°s√°ra szolg√°l√≥ f√ºggv√©nyek (<span class="kodreszlet">keydown</span> √©s <span class="kodreszlet">keyup</span> esem√©nyek) rendelkez√©sre √°llnak, azonban a <span class="kodreszlet">billenty≈±k</span> t√∂mb√∂t m√©g l√©tre kell hoznunk.</p>

            <pre>
                <code>
// egy√©b v√°ltoz√≥k
let vizek = [];
<span class="kodkiemeles">let billenty≈±k = [];</span>

let vesztett√©l = false;
let nyert√©l = false;
                </code>
            </pre>

            <p>A mozg√°s a lenyomott billenty≈±t≈ël f√ºgg. Ha ez a felfel√© mutat√≥ ny√≠l, akkor egy sorral fentebb mozog a <span class="kodreszlet">robot</span>, vagyis az ≈ë <span class="kodreszlet">y</span> √©rt√©ke egyel kisebb lesz, v√≠zszintes poz√≠ci√≥ja viszont nem v√°ltozik. Teh√°t a jelenlegi helyzet√©hez k√©pest a v√≠zszintes √©s f√ºgg≈ëleges poz√≠ci√≥ja √≠gy v√°ltozik: <span class="kodreszlet">(0, -1)</span>. Az √∂sszes eset:</p>

            <ul>
                <li><b>fel</b>: <span class="kodreszlet">(0, -1)</span></li>
                <li><b>le</b>: <span class="kodreszlet">(0, 1)</span></li>
                <li><b>jobbra</b>: <span class="kodreszlet">(1, 0)</span></li>
                <li><b>balra</b>: <span class="kodreszlet">(-1, 0)</span></li>
            </ul>

            <p>Ezeket az esem√©nyeket kezelj√ºk le a <span class="kodreszlet">friss√≠t√©s</span> f√ºggv√©nyben, de a konkr√©t mozg√°st szervezz√ºk ki a <span class="kodreszlet">mozgasIranyban(x, y)</span> f√ºggv√©nybe. Ki√≠r√°ssal ellen≈ërizz√ºk, hogy j√≥ ir√°nyba mozduln√°nk-e el. A k√≥d v√©g√©n defini√°ljuk (de m√©g ne t√∂lts√ºk ki) a <span class="kodreszlet">mozgasIranyban(x, y)</span> f√ºggv√©nyt, hogy ne kapjunk hiba√ºzenetet.</p>

            <pre>
                <code>
function friss√≠t√©s(dt) {
    // Billenty≈±k figyel√©se
    <span class="kodkiemeles">if (billenty≈±k['ArrowDown']) {
        mozgasIranyban(0, 1);
        console.log('le');
    }
    if (billenty≈±k['ArrowUp']) {
        mozgasIranyban(0, -1);
        console.log('fel');
    }
    if (billenty≈±k['ArrowLeft']) {
        mozgasIranyban(-1, 0);
        console.log('balra');
    }
    if (billenty≈±k['ArrowRight']) {
        mozgasIranyban(1, 0);
        console.log('jobbra');
    }</span>

    // robot cs√∫sztat√°sa
    

    // c√©lba √©r√©s
    
}
                </code>
            </pre>

            <div class="kepsor">
                <figure>
                    <img src="k√©pek/robot-iranyok-kiirasa.png">
                    <figcaption>A lenyomott gombok eset√©n ki√≠rt sz√∂veg</figcaption>
                </figure>
            </div>

            <p>A <span class="kodreszlet">mozgasIranyban</span> f√ºggv√©nyben el≈ëk√©sz√≠tj√ºk a <span class="kodreszlet">robot</span> mozg√°s√°t, de csak akkor, ha az √∫j hely m√©g a p√°ly√°n bel√ºl van, √©s az adott mez≈ë szabad (<span class="kodreszlet">" "</span>) vagy a robot eredeti helye (<span class="kodreszlet">"R"</span>), k√ºl√∂nben vesztett√ºnk.</p>

            <pre>
                <code>
// lenyomott billenty≈±k elt√°rol√°sa
document.addEventListener('keydown', e => {
    billenty≈±k[e.key] = true;
})

document.addEventListener('keyup', e => {
    billenty≈±k[e.key] = false;
})

function mozgasIranyban(dx, dy) {
    <span class="kodkiemeles">const ujX = robot.x + x;
    const ujY = robot.y + y;

    // Ellen≈ërz√©s: a c√©lpont a p√°lya hat√°rain bel√ºl van-e, √©s √ºres helyre l√©p-e vagy az eredeti hely√©re
    if (ujY >= 0 && ujY &lt; p√°lya.length && ujX >= 0 && ujX &lt; p√°lya[0].length && p√°lya[ujY][ujX] == " " || p√°lya[ujY][ujX] == "R") {
        robot.v√©gx = ujX;
        robot.v√©gy = ujY;
        robot.kezdi = performance.now(); // Mozg√°s kezd√©si id≈ëpontja
        robot.kezdx = robot.x;          // Jelenlegi poz√≠ci√≥ ment√©se
        robot.kezdy = robot.y;
    } else {
        vesztett√©l = true;
    }</span>
}
                </code>
            </pre>

            <p>A fenti k√≥dban a mozg√°s el≈ëk√©sz√≠t√©se m√©g magyar√°zatra v√°r. A <span class="kodreszlet">robot</span> mozg√°sa k√©t v√©gpont k√∂z√∂tt t√∂rt√©nik. Ezen k√©t pont k√∂z√∂tt egyenletes sebess√©ggel halad √©s minden l√©p√©s ugyanannyi ideig tart. Tegy√ºk fel, hogy minden l√©p√©s 300 ms-ig (milliszekundumig) tart. H√≠vjuk ezt halad√°si id≈ënek (<span class="kodreszlet">hi</span>), √©s t√°roljuk el a <span class="kodreszlet">robot</span> tulajdons√°gak√©nt. Hogyan lehet megalkotni az egyenletes mozg√°st? Ha ismerj√ºk, hogy honnan indul, hov√° √©rkezik √©s mennyi id≈ë alatt, akkor k√∂nnyen kisz√°m√≠thatunk egy <b>ar√°ny</b>t, ami megmondja, hogy az id≈ë m√∫l√°s√°val hol kell √©ppen tartania. Ha az √∫t 300 ms-ig tart, akkor 100 ms eltelt√©vel az √∫t egyharmad√°n√°l kell tartania a <span class="kodreszlet">robot</span>nak. A fenti ar√°ny kisz√°m√≠t√°s√°hoz azonban (a billenty≈± lenyom√°s√°nak pillanat√°ban) ki kell sz√°molnunk a <span class="kodreszlet">robot</span> √∫j v√≠zszintes √©s f√ºgg≈ëleges hely√©t (<span class="kodreszlet">v√©gx</span> √©s <span class="kodreszlet">v√©gy</span>), valamint el kell t√°rolnunk a jelenlegi v√≠zszintes √©s f√ºgg≈ëleges hely√©t (<span class="kodreszlet">kezdx</span> √©s <span class="kodreszlet">kezdy</span>), tov√°bb√° a mozg√°s kezdet√©nek idej√©t (<span class="kodreszlet">kezdi</span>). Ezek legyenek a <span class="kodreszlet">robot</span> <b>√∫j tulajdons√°gai</b>, vagyis z√°rjuk ezeket is a <span class="kodreszlet">robot</span> objektumba.</p>

            <p>A <span class="kodreszlet">robot</span> objektum b≈ëv√≠t√©se:</p>

            <pre>
                <code>
/*V√°ltoz√≥k*/
// robot
let robot = {
    x: 0,
    y: 0,
    sz√©less√©g: M,
    magass√°g: M<span class="kodkiemeles">,
    hi: 300,    // halad√°s id≈ëtartama szomsz√©dos mez≈ëre (m√©rt√©kegys√©g: ms)
    kezdx: 0,   // halad√°s kezd≈ë x poz√≠ci√≥ja (mez≈ë)
    kezdy: 0,   // halad√°s kezd≈ë y poz√≠ci√≥ja (mez≈ë)
    kezdi: 0,   // halad√°s kezd≈ë id≈ëpontja (ms)
    v√©gx: 0,    // halad√°s v√©gs≈ë x poz√≠ci√≥ja (mez≈ë)
    v√©gy: 0     // halad√°s v√©gs≈ë y poz√≠ci√≥ja (mez≈ë)</span>
}
                </code>
            </pre>

            <p>Ezeket m√°r a j√°t√©k indul√°sakor be kell √°ll√≠tanunk a <span class="kodreszlet">robot</span> p√°ly√°n elfoglalt hely√©nek alapj√°n.</p>

            <pre>
                <code>
// a p√°lya t√∂mb bej√°r√°sa sorfolytonosan
for (let y = 0; y &lt; p√°lya.length; y++) {
    for (let x = 0; x &lt; p√°lya[y].length; x++) {
        switch (p√°lya[y][x]) {
            case "V":
                vizek.push({ x: x, y: y, sz√©less√©g: M, magass√°g: M })
                break;
            case "R":
                robot.x = x;
                robot.y = y;
                <span class="kodkiemeles">robot.kezdx = x;
                robot.kezdy = y;
                robot.v√©gx = x;
                robot.v√©gy = y;</span>
                break;
        }
    }    
}
                </code>
            </pre>

            <h4>A robot cs√∫sztat√°sa</h4>

            <p>Minden adat rendelkez√©s√ºnkre √°ll a <span class="kodreszlet">robot</span> mozg√°s k√∂zbeni folytonos kirajzol√°s√°ra. Sz√°moljuk ki a mozg√°s kezdete (billenty≈±lenyom√°s) √≥ra eltelt id≈ët (<span class="kodreszlet">id≈ëK√ºl</span>). Ha ez az eltelt id≈ë m√©g nem √©rte el a halad√°sra sz√°nt id≈ët (<span class="kodreszlet">hi</span>), akkor sz√°moljuk ki az ar√°nyt, vagyis azt a helyet, ahol a robotnak tartania kell a halad√°sban √©s tegy√ºk arra a helyre. K√ºl√∂nben tegy√ºk a <span class="kodreszlet">robot</span>ot a v√©gs≈ë hely√©re.</p>


            <pre>
                <code>
function friss√≠t√©s(dt) {
    // Billenty≈±k figyel√©se
    ...

    // robot cs√∫sztat√°sa
    <span class="kodkiemeles">let id≈ëK√ºl = id≈ë - robot.kezdi;     // minden k√©perny≈ëfriss√≠t√©sn√©l kisz√°molja, mennyi id≈ë telt el a robot elindul√°sa √≥ta ms-ban
    if(id≈ëK√ºl &lt; robot.hi) {             // ha ez az id≈ëk√ºl√∂nbs√©g kisebb, mint a halad√°s id≈ëtartama, akkor
        let ar√°ny = id≈ëK√ºl / robot.hi;  // ez alapj√°n √∫jrasz√°molunk egy ar√°nyt (0 √©s 1 k√∂z√∂tti √©rt√©k)
        robot.x = robot.kezdx + (robot.v√©gx - robot.kezdx) * ar√°ny;  // az ar√°nnyal friss√≠tj√ºk a robot helyzet√©t
        robot.y = robot.kezdy + (robot.v√©gy - robot.kezdy) * ar√°ny;
    } else {    // k√ºl√∂nben ha a robot indul√°sa √≥ta eltelt id≈ë ms-ban nagyobb vagy egyenl≈ë, mint az ≈ë halad√°si ideje (vagyis amennyi ms alatt oda kell √©rnie a c√©lba), akkor tegy√ºk ≈ët a c√©lhelyre
        robot.x = robot.v√©gx;
        robot.y = robot.v√©gy;
    }</span>

    // c√©lba √©r√©s
    
}
                </code>
            </pre>

            <p>Pr√≥b√°ljuk ki a j√°t√©kot √©s l√°tni fogjuk, hogy az al√°bbi <b>hiba√ºzenetet</b> kapjuk.</p>

            <div class="kepsor">
                <figure>
                    <img src="k√©pek/robot-mozgas-hiba.png">
                    <figcaption>Hiba az √∫j szabad mez≈ëre l√©p√©skor</figcaption>
                </figure>
            </div>

            <p>A hiba oka az, hogy ah√°nyszor megt√∂rt√©nik a k√©perny≈ëfriss√≠t√©s egy gomb lenyomva tart√°sa alatt, annyiszor sz√°m√≠tjuk ki az √∫j helyet. Mivel a k√©perny≈ëfriss√≠t√©s elk√©peszt≈ë sokszor megy v√©gbe r√∂vid id≈ën bel√ºl, ez√©rt olyan helyet sz√°molunk ki a robotnak, ami m√°r messze nem a p√°lya r√©sze. Megold√°s lehet, ha csak akkor sz√°molunk √∫jabb helyet, ha √©ppen nem mozog a robot. Erre vezess√ºk be a <span class="kodreszlet">mozog</span> v√°ltoz√≥t hamis kezd≈ë√©rt√©kkel, amely legyen igaz, ha a robot mozog, √©s hamis, ha nem mozog.</p>

            <pre>
                <code>
// egy√©b v√°ltoz√≥k
let vizek = [];
let billenty≈±k = [];

<span class="kodkiemeles">let mozog = false;</span>
let vesztett√©l = false;
let nyert√©l = false;
                </code>
            </pre>

            <p>Csak akkor kezdhess√ºnk bele √∫jabb mozg√°sba, ha √©ppen nem mozgunk.</p>

            <pre>
                <code>
function friss√≠t√©s(dt) {
    // Billenty≈±k figyel√©se
    <span class="kodkiemeles">if (!mozog) {</span>
        if (billenty≈±k['ArrowDown']) {
            mozgasIranyban(0, 1);
        }
        if (billenty≈±k['ArrowUp']) {
            mozgasIranyban(0, -1);
        }
        if (billenty≈±k['ArrowLeft']) {
            mozgasIranyban(-1, 0);
        }
        if (billenty≈±k['ArrowRight']) {
            mozgasIranyban(1, 0);
        }

        ...
    <span class="kodkiemeles">}</span>
}
                </code>
            </pre>

            <p>√Åll√≠tsuk igazra a <span class="kodreszlet">mozog</span> v√°ltoz√≥t a mozg√°s megkezd√©se el≈ëtt, pl. a <span class="kodreszlet">mozgasIranyban</span> f√ºggv√©nyben.</p>

            <pre>
                <code>
function mozgasIranyban(x, y) {
    const ujX = robot.x + x;
    const ujY = robot.y + y;

    // Ellen≈ërz√©s: a c√©lpont a p√°lya hat√°rain bel√ºl van-e, √©s √ºres helyre l√©p-e vagy az eredeti hely√©re
    if (ujY >= 0 && ujY &lt; p√°lya.length && ujX >= 0 && ujX &lt; p√°lya[0].length && p√°lya[ujY][ujX] == " " || p√°lya[ujY][ujX] == "R") {
        robot.v√©gx = ujX;
        robot.v√©gy = ujY;
        robot.kezdi = performance.now(); // Mozg√°s kezd√©si id≈ëpontja
        robot.kezdx = robot.x;          // Jelenlegi poz√≠ci√≥ ment√©se
        robot.kezdy = robot.y;
        <span class="kodkiemeles">mozog = true;</span>
    } else {
        vesztett√©l = true;
    }
}
                </code>
            </pre>

            <p>Majd √°ll√≠tsuk vissza hamisra a mozg√°s befejez√©sekor.</p>

            <pre>
                <code>
function friss√≠t√©s(dt) {
    // Billenty≈±k figyel√©se
    ...

    // robot cs√∫sztat√°sa
    let id≈ëK√ºl = id≈ë - robot.kezdi;     // minden k√©perny≈ëfriss√≠t√©sn√©l kisz√°molja, mennyi id≈ë telt el a robot elindul√°sa √≥ta ms-ban
    if(id≈ëK√ºl &lt; robot.hi) {             // ha ez az id≈ëk√ºl√∂nbs√©g kisebb, mint a halad√°s id≈ëtartama, akkor
        let ar√°ny = id≈ëK√ºl / robot.hi;  // ez alapj√°n √∫jrasz√°molunk egy ar√°nyt (0 √©s 1 k√∂z√∂tti √©rt√©k)
        robot.x = robot.kezdx + (robot.v√©gx - robot.kezdx) * ar√°ny;  // az ar√°nnyal friss√≠tj√ºk a robot helyzet√©t
        robot.y = robot.kezdy + (robot.v√©gy - robot.kezdy) * ar√°ny;
    } else {    // k√ºl√∂nben ha a robot indul√°sa √≥ta eltelt id≈ë ms-ban nagyobb vagy egyenl≈ë, mint az ≈ë halad√°si ideje (vagyis amennyi ms alatt oda kell √©rnie a c√©lba), akkor tegy√ºk ≈ët a c√©lhelyre
        robot.x = robot.v√©gx;
        robot.y = robot.v√©gy;
        <span class="kodkiemeles">mozog = false;</span>
    }

    // c√©lba √©r√©s
    
}
                </code>
            </pre>

            <h4>Id≈ë ki√≠r√°sa ‚åõ</h4>

            <p>A j√°t√©k kezdete √≥ta eltelt id≈ët az <span class="kodreszlet">id≈ë</span> v√°ltoz√≥ tartalmazza. V√°ltsuk √°t ezt a ms-ban t√°rolt √©rt√©ket m√°sodpercre, majd kerek√≠ts√ºk eg√©szre √©s √≠rjuk ki a "..." hely√©re.</p>

            <pre>
                <code>
// id≈ë
ctx.font = '20px Arial';
ctx.fillStyle = 'black';
ctx.fillText('‚åõ:<span class="kodkiemeles">' + Math.floor(id≈ë / 1000)</span>, 10, 30);
                </code>
            </pre>

            <h4>Gy≈ëzelem</h4>

            <p>A j√°t√©knak k√©t esetben van v√©ge:</p>

            <ol>
                <li>ha beleest√ºnk a v√≠zbe, vagy</li>
                <li><b>ha kijutottunk a labirintusb√≥l</b>.</li>
            </ol>

            <p>Ut√≥bbi m√©g kialak√≠t√°sra v√°r a <span class="kodreszlet">friss√≠t√©s</span> f√ºggv√©nyben. A c√©lk√©nt szolg√°l√≥ mez≈ë helye v√≠zszintesen <span class="kodreszlet">7</span>, f√ºgg≈ëlegesen <span class="kodreszlet">0</span>, ez√©rt ha a <span class="kodreszlet">robot</span> <span class="kodreszlet">x</span> <b>√©s</b> <span class="kodreszlet">y</span> poz√≠ci√≥ja megegyezik ezzel a sz√°mp√°rossal, akkor a <span class="kodreszlet">nyert√©l</span> v√°ltoz√≥ legyen igaz.</p>

            <pre>
                <code>
// c√©lba √©r√©s
<span class="kodkiemeles">if(robot.x == 7 && robot.y == 0) {
    nyert√©l = true;
}</span>
                </code>
            </pre>

            <p>Ekkor ne csak a "Nyert√©l" felirat jelenjen meg, hanem teljesen legyen v√©ge a j√°t√©knak.</p>

            <pre>
                <code>
/* === ANIM√ÅCI√ìS CIKLUS === */

k√∂vetkez≈ë(); // az anim√°ci√≥ elind√≠t√°sa

function k√∂vetkez≈ë() {
    id≈ë = performance.now();
    friss√≠t√©s(id≈ë); // √°llapott√©r friss√≠t√©se
    rajzol√°s(); // k√©pkocka √∫jrarajzol√°sa
    <span class="kodkiemeles">if(!vesztett√©l && !nyert√©l) {</span>
        requestAnimationFrame(k√∂vetkez≈ë);
    <span class="kodkiemeles">}</span>
}
                </code>
            </pre>

            <p><b>Ezzel elk√©sz√ºlt√ºnk a j√°t√©kkal.</b> üòé</p>

            <div  class="feladatextra">
                <p><b>‚ú®EXTRA Feladat</b><br>M√≥dos√≠tsd √∫gy a <span class="kodreszlet">robot</span> mozg√°s√°t √∫gy, hogy mindig az ellent√©tes ir√°nyba mozogjon.</p>

                <details>
                    <summary>Megold√°s</summary>
                        <pre>
                            <code>
const canvas = document.querySelector('canvas');
const ctx = canvas.getContext('2d');

/* === √ÅLLAPOTT√âR === */

/*P√°lya t√°rol√°sa*/
let p√°lya = [
    "VVVVVVV V",
    "V       V",
    "V VV VV V",
    "VVV     V",
    "V   V V V",
    "V VV  V V",
    "VRV   V V",
    "VVVVVVVVV"
];

/*Konstansok*/
const M = 40; // mez≈ëm√©ret

let robotk√©p = new Image();
robotk√©p.src = 'robot.png';

/*V√°ltoz√≥k*/
// robot
let robot = {
    x: 0,
    y: 0,
    sz√©less√©g: M,
    magass√°g: M,    
    hi: 300,    // halad√°s id≈ëtartama szomsz√©dos mez≈ëre (m√©rt√©kegys√©g: ms)
    kezdx: 0,   // halad√°s kezd≈ë x poz√≠ci√≥ja (mez≈ë)
    kezdy: 0,   // halad√°s kezd≈ë y poz√≠ci√≥ja (mez≈ë)
    kezdi: 0,   // halad√°s kezd≈ë id≈ëpontja (ms)
    v√©gx: 0,    // halad√°s v√©gs≈ë x poz√≠ci√≥ja (mez≈ë)
    v√©gy: 0     // halad√°s v√©gs≈ë y poz√≠ci√≥ja (mez≈ë)
}

// egy√©b v√°ltoz√≥k
let vizek = [];
let billenty≈±k = [];

let mozog = false;
let vesztett√©l = false;
let nyert√©l = false;


// a p√°lya t√∂mb bej√°r√°sa sorfolytonosan
for (let y = 0; y &lt; p√°lya.length; y++) {
    for (let x = 0; x &lt; p√°lya[y].length; x++) {
        switch (p√°lya[y][x]) {
            case "V":
                vizek.push({ x: x, y: y, sz√©less√©g: M, magass√°g: M })
                break;
            case "R":
                robot.x = x;
                robot.y = y;
                robot.kezdx = x;
                robot.kezdy = y;
                robot.v√©gx = x;
                robot.v√©gy = y;
                break;
        }
    }    
}


/* === ANIM√ÅCI√ìS CIKLUS === */

//let id≈ë = performance.now();

k√∂vetkez≈ë(); // az anim√°ci√≥ elind√≠t√°sa

function k√∂vetkez≈ë() {
    id≈ë = performance.now();
    friss√≠t√©s(id≈ë); // √°llapott√©r friss√≠t√©se
    rajzol√°s(); // k√©pkocka √∫jrarajzol√°sa
    if(!vesztett√©l && !nyert√©l) {
        requestAnimationFrame(k√∂vetkez≈ë);
    }
}

function rajzol√°s() {
    // h√°tt√©r
    ctx.fillStyle = 'orange';
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // vizek
    ctx.fillStyle = 'lightblue';
    vizek.forEach(v√≠z => {
        ctx.fillRect(v√≠z.x * M, v√≠z.y * M, v√≠z.sz√©less√©g, v√≠z.magass√°g);
    });

    // robot
    ctx.drawImage(robotk√©p, robot.x * M, robot.y * M, robot.sz√©less√©g, robot.magass√°g);
    
    // nyertes sz√∂veg
    if(nyert√©l) {
        ctx.font = '80px Arial';
        ctx.fillStyle = 'black';
        ctx.fillText('Nyert√©l', 50, 170);
    }

    // v√≠zbe es√©s
    if(vesztett√©l) {
        ctx.font = '40px Arial';
        ctx.fillStyle = 'black';
        ctx.fillText('üåäV√≠zbe est√©lüåä', 30, 170);
    }
    
    // id≈ë
    ctx.font = '20px Arial';
    ctx.fillStyle = 'black';
    ctx.fillText('‚åõ: ' + Math.floor(id≈ë / 1000), 10, 30);
}

function friss√≠t√©s(dt) {
    // Billenty≈±k figyel√©se
    if (!mozog) {
        if (billenty≈±k['ArrowDown']) {
            mozgasIranyban(<span class="kodkiemeles">0, -1</span>);
        }
        if (billenty≈±k['ArrowUp']) {
            mozgasIranyban(<span class="kodkiemeles">0, 1</span>);
        }
        if (billenty≈±k['ArrowLeft']) {
            mozgasIranyban(<span class="kodkiemeles">1, 0</span>);
        }
        if (billenty≈±k['ArrowRight']) {
            mozgasIranyban(<span class="kodkiemeles">-1, 0</span>);
        }
    }

    // robot cs√∫sztat√°sa
    let id≈ëK√ºl = id≈ë - robot.kezdi;     // minden k√©perny≈ëfriss√≠t√©sn√©l kisz√°molja, mennyi id≈ë telt el a robot elindul√°sa √≥ta ms-ban
    if(id≈ëK√ºl &lt; robot.hi) {             // ha ez az id≈ëk√ºl√∂nbs√©g kisebb, mint a halad√°s id≈ëtartama, akkor
        let ar√°ny = id≈ëK√ºl / robot.hi;  // ez alapj√°n √∫jrasz√°molunk egy ar√°nyt (0 √©s 1 k√∂z√∂tti √©rt√©k)
        robot.x = robot.kezdx + (robot.v√©gx - robot.kezdx) * ar√°ny;  // az ar√°nnyal friss√≠tj√ºk a robot helyzet√©t
        robot.y = robot.kezdy + (robot.v√©gy - robot.kezdy) * ar√°ny;
    } else {    // k√ºl√∂nben ha a robot indul√°sa √≥ta eltelt id≈ë ms-ban nagyobb vagy egyenl≈ë, mint az ≈ë halad√°si ideje (vagyis amennyi ms alatt oda kell √©rnie a c√©lba), akkor tegy√ºk ≈ët a c√©lhelyre
        robot.x = robot.v√©gx;
        robot.y = robot.v√©gy;
        mozog = false;
    }

    // c√©lba √©r√©s
    if(robot.x == 7 && robot.y == 0) {
        nyert√©l = true;
    }
}

/* === ESEM√âNYEK === */

// lenyomott billenty≈±k elt√°rol√°sa
document.addEventListener('keydown', e => {
    billenty≈±k[e.key] = true;
})

document.addEventListener('keyup', e => {
    billenty≈±k[e.key] = false;
})

function mozgasIranyban(x, y) {
    const ujX = robot.x + x;
    const ujY = robot.y + y;

    // Ellen≈ërz√©s: a c√©lpont a p√°lya hat√°rain bel√ºl van-e, √©s √ºres helyre l√©p-e
    if (ujY >= 0 && ujY &lt; p√°lya.length && ujX >= 0 && ujX &lt; p√°lya[0].length && p√°lya[ujY][ujX] == " " || p√°lya[ujY][ujX] == "R") {
        robot.v√©gx = ujX;
        robot.v√©gy = ujY;
        robot.kezdi = performance.now(); // Mozg√°s kezd√©si id≈ëpontja
        robot.kezdx = robot.x;          // Jelenlegi poz√≠ci√≥ ment√©se
        robot.kezdy = robot.y;
        mozog = true;
    } else {
        vesztett√©l = true;
    }
}
                            </code>
                        </pre>
                </details>
            </div>

        </div>

    </main>

    <footer>

    </footer>
</body>
</html>