<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="anyag.css" title="normal">
    <!--<link rel="alternate stylesheet" type="text/css" href="nagybetus.css" title="nagybetus">-->
    <link rel="icon" type="image" href="k√©pek/favicon-curly-bracket.png">
    <title>Pac-man - Webes j√°t√©kok szakk√∂r</title>
</head>
<body>
    <header>
        <ul>
            <li><a href="index.html">Kezd≈ëlap</a></li>
            <li>Forr√°sok</li>
            <li>√ìrav√°zlatok</li>
            <li>R√≥lunk</li>
        </ul>
    </header>

    <main>
        <div class="cim">
            <div>
                <p><span></span>Szakk√∂ri seg√©danyag</p>
                <h1>Pac-man üëª</h1>
            </div>
        </div>
        
        <div class="anyag">
            <h2>√Åttekint√©s</h2>

            <div class="informacio-ido">
                <figure>
                    <img src="k√©pek/√≥ra.png">
                </figure>
                <p>45'</p>
            </div>
            <div class="informacio-szint">
                <figure>
                    <img src="k√©pek/csillag.png">
                </figure>
                <p>k√∂nny≈±</p>
            </div>

            <h3>A j√°t√©k c√©lja</h3>
            <p>Ebben a projektben a h√≠res <b>Pac-Man</b> j√°t√©kot k√©sz√≠tj√ºk el, ennek √©rtelm√©ben a j√°t√©k c√©lja ugyanaz: √∂sszegy≈±jteni az √∂sszes √©rm√©t ü™ô an√©lk√ºl, hogy a szellemek üëª elkapn√°nak. A csavar azonban az, hogy a hatalmas j√°t√©kt√©rnek csak egy bizonyos r√©sz√©t l√°tjuk egyszerre üîç. Neked siker√ºl √∂sszegy≈±jteni az √∂sszes √©rm√©t?</p>
            
            <a href="15 Pacman/index.html">
                <div class="megtekintes-gomb">
                    <p>Interakt√≠v p√©lda</p>
                </div>
            </a>

        </div>

        <div class="utmutato">
            <h2>√ötmutat√≥</h2>
            <p>Az √∫tmutat√≥ a <a href="https://code.visualstudio.com/" target="_blank">Visual Studio Code</a> fejleszt≈ëi k√∂rnyezethez k√©sz√ºlt.</p>

            <h3>HTML</h3>

            <p>A kiindul√≥ HTML f√°jl.</p>

            <pre>
                <code>
&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;title&gt;Pac-man&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;Pac-man&lt;/h1&gt;
    &lt;canvas width="600" height="400"&gt;&lt;/canvas&gt;
    &lt;script src="index.js"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
                </code>
            </pre>

            
            <h3>JavaScript</h3>
            
            <p>A kiindul√≥ JavaScript f√°jl.</p>

            <pre>
                <code>
const canvas = document.querySelector('canvas');
const ctx = canvas.getContext('2d');

/* === √ÅLLAPOTT√âR === */

/*P√°lya t√°rol√°sa*/
let p√°lya = [
    "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFF",
    "F    MF       FF    F S      F",
    "F F FFFFFFFFF FF FFFFFF FFF FF",
    "F  S  FS            F   F    F",
    "FFF FFF FFFFFFFFFFF FFFFFF F F",
    "F    EF       FF  F F   E  F F",
    "F FFF F FFFFFFFFF   FFFFF FFFF",
    "F   F    F F FFFFFFS         F",
    "F  S  F    F        FFF FFF FF",
    "FFF FFFFFF FF FF FFFFFFFFFFFFF",
    "FFF FFFFFF FF FF FFFFFFFFFFFFF",
    "F   FFF       FF  F   F      F",
    "F F F FFFFFFF FFF F FFFFF FFFF",
    "F       F    SFF      F  S   F",
    "FFF F F FFF FFFFFFFFF F FF FFF",
    "F  FFE SF F F FFF F  S S    FF",
    "F F F F F F F FFF FFF F F F FF",
    "F    S  F             F F F EF",
    "FFF F FFF FFF FFF FFFFF FFFFFF",
    "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFF"
    ]

/*Konstansok*/
const M = 40; // mez≈ëm√©ret

const k√©pek = {
    pacman: new Image(),
    szellemaktiv: new Image(),
    szelleminaktiv: new Image(),
    √©rme: new Image(),
    extra√©rme: new Image(),
    falk√©p: new Image()
}

k√©pek.pacman.src = 'pacman.png';
k√©pek.szellemaktiv.src = 'szellemaktiv.png';
k√©pek.szelleminaktiv.src = 'szelleminaktiv.png';
k√©pek.√©rme.src = '√©rme.png';
k√©pek.extra√©rme.src = 'extra√©rme.png';
k√©pek.falk√©p.src = 'fal.png';

/*V√°ltoz√≥k*/
let pacman = {
    x: 0,
    y: 0,
    sz√©less√©g: M,
    magass√°g: M,    
    hi: 300, //halad√°s id≈ëtartama szomsz√©dos mez≈ëre (m√©rt√©kegys√©g: ms)
    kezdx: 0, //halad√°s kezd≈ë x poz√≠ci√≥ja (mez≈ë)
    kezdy: 0, //halad√°s kezd≈ë y poz√≠ci√≥ja (mez≈ë)
    kezdi: 0, //halad√°s kezd≈ë id≈ëpontja (ms)
    v√©gx: 0, //halad√°s v√©gs≈ë x poz√≠ci√≥ja (mez≈ë)
    v√©gy: 0 //halad√°s v√©gs≈ë y poz√≠ci√≥ja (mez≈ë)
}

let falak = [];
let szellemek = [];
let billenty≈±k = [];
let √©rm√©k = [];
let extr√°k = [];

let mozog = false;
let gy≈ëzelem = false;
let veres√©g = false;

// p√°lyabe√°ll√≠t√°s


/* === ANIM√ÅCI√ìS CIKLUS === */

let el≈ëz≈ëId≈ë = performance.now();

k√∂vetkez≈ë(); // az anim√°ci√≥ elind√≠t√°sa

function k√∂vetkez≈ë() {
    aktu√°lisId≈ë = performance.now();
    let dt = (aktu√°lisId≈ë - el≈ëz≈ëId≈ë) / 1000;
    el≈ëz≈ëId≈ë = aktu√°lisId≈ë;
    friss√≠t√©s(dt); // √°llapott√©r friss√≠t√©se
    rajzol√°s(); // k√©pkocka √∫jrarajzol√°sa
    if(!veres√©g && !gy≈ëzelem) {
        requestAnimationFrame(k√∂vetkez≈ë);
    }
}

function rajzol√°s() {
    // h√°ny csempe van v√≠zszintesen √©s f√ºgg≈ëlegesen
    

    // negyed kezdet√©nek kisz√°mol√°sa
    

    // h√°tt√©r
    

    // elmentj√ºk a jelenlegi √°llapotot
    

    // canvas eltol√°sa
    

    // falak
    

    // √©rm√©k
    

    // extra √©rm√©k kirajzol√°sa
    

    // pacman
    

    // szellemek
    

    // s√°v
    

    // eredeti √°llapotot vissza√°ll√≠t√°sa
    

    // nyertes sz√∂veg
    if(gy≈ëzelem) {
        ctx.font = '80px Courier New';
        ctx.fillStyle = 'white';
        ctx.fillText('Nyert√©l', 130, 200);
        ctx.fillText('Nyert√©l', 780, 200);
        ctx.fillText('Nyert√©l', 130, 600);
        ctx.fillText('Nyert√©l', 780, 600);
    }
    // vesztes sz√∂veg
    if(veres√©g) {
        ctx.font = '80px Courier New';
        ctx.fillStyle = 'white';
        ctx.fillText('Vesztett√©l', 70, 200);
        ctx.fillText('Vesztett√©l', 740, 200);
        ctx.fillText('Vesztett√©l', 70, 600);
        ctx.fillText('Vesztett√©l', 740, 600);
    }
}

function friss√≠t√©s(dt) {
    // Billenty≈±k figyel√©se
    

    // pacman ir√°ny√≠t√°sa    
    

    // szellemek mozg√°sa
    

    // √©rme begy≈±jt√©se
    

    // visszasz√°ml√°l√°s
    

    // veres√©g
    

    // gy≈ëzelem
    
}

/* === ESEM√âNYEK === */

// lenyomott billenty≈±k elt√°rol√°sa
document.addEventListener('keydown', e =&gt; {
    billenty≈±k[e.key] = true;
})

document.addEventListener('keyup', e =&gt; {
    billenty≈±k[e.key] = false;
})

function mozgasIranyban(x, y) {
    const ujX = pacman.x + x;
    const ujY = pacman.y + y;

    // Ellen≈ërz√©s: a c√©lpont a p√°lya hat√°rain bel√ºl van-e, √©s l√©phet-e oda
    if (ujY &gt;= 0 && ujY &lt; p√°lya.length && ujX &gt;= 0 && ujX &lt; p√°lya[0].length && [" ", "M", "S", "A", "E", "B", "C"].includes(p√°lya[ujY][ujX])) {
        pacman.v√©gx = ujX;
        pacman.v√©gy = ujY;
        pacman.kezdi = performance.now(); // Mozg√°s kezd√©si id≈ëpontja
        pacman.kezdx = pacman.x;          // Jelenlegi poz√≠ci√≥ ment√©se
        pacman.kezdy = pacman.y;
        mozog = true;
    }
}

function √ºtk√∂znek(t√©glalap1, t√©glalap2) {
    return !(
        t√©glalap2.x * M + t√©glalap2.sz√©less√©g &lt;= t√©glalap1.x * M ||
        t√©glalap2.y * M + t√©glalap2.magass√°g &lt;= t√©glalap1.y * M ||
        t√©glalap2.x * M &gt;= t√©glalap1.x * M + t√©glalap1.sz√©less√©g ||
        t√©glalap2.y * M &gt;= t√©glalap1.y * M + t√©glalap1.magass√°g
    )
}
                </code>
            </pre>

            <h4>K√©pek</h4>

            <ul>
                <li><a href="../15 Pacman kiindul√°s/√©rme.png" target="_blank">√©rme.png</a></li>
                <li><a href="../15 Pacman kiindul√°s/extra√©rme.png" target="_blank">extra√©rme.png</a></li>
                <li><a href="../15 Pacman kiindul√°s/fal.png" target="_blank">fal.png</a></li>
                <li><a href="../15 Pacman kiindul√°s/pacman.png" target="_blank">pacman.png</a></li>
                <li><a href="../15 Pacman kiindul√°s/szellemaktiv.png" target="_blank">szellemaktiv.png</a></li>
                <li><a href="../15 Pacman kiindul√°s/szelleminaktiv.png" target="_blank">szelleminaktiv.png</a></li>
            </ul>

            <h4>A j√°t√©k √∫jdons√°ga: m√°szk√°l√≥s j√°t√©k</h4>

            <p>Ez a j√°t√©k a legt√∂bb dologban megegyezik a Kincskeres≈ë j√°t√©kkal, de egy fontos szempontb√≥l elt√©r att√≥l: ez egy m√°szk√°l√≥s j√°t√©k. Ezeknek a j√°t√©koknak a l√©nyege a felfedez√©s, ami gyakran egyszerre t√∂bb helysz√≠nen (teremben) zajlik. Ebben a j√°t√©kban ezt a t√≠pust √∂tv√∂zz√ºk a Pac-Man j√°t√©kkal, √©s mivel ez a j√°t√©k csak ebben a tekintetben t√©r el a Kincskeres≈ët≈ël, jelen √∫tmutat√≥ban csak err≈ël a "t√∂bb j√°t√©kter≈±s√©gr≈ël" olvashatsz.</p>

            <h4>Hogy n√©z ki az eredeti p√°lya?</h4>

            <p>Az eredeti p√°lya egy <b>nagyobb ter√ºlet</b>, melynek csak egy <b>negyed√©t</b> l√°tjuk egyszerre. A canvas m√©rete megegyezik egy negyed m√©ret√©vel. Az al√°bbi k√©pen l√°that√≥ a n√©gy r√©szre felosztott p√°lya.</p>

            <div class="kepsor">
                <figure>
                    <img src="k√©pek/pacman-palya-terv.png">
                    <figcaption>A teljes p√°lya</figcaption>
                </figure>
            </div>

            <p>A negyedek n√©gyzetr√°csain t√∂rt√©n≈ë mozg√°s v√°ltozatlan, ak√°rcsak a p√°lya bej√°r√°sa √©s a szerepl≈ëk poz√≠ci√≥inak be√°ll√≠t√°sa a p√°lyabej√°r√°s sor√°n. A tr√ºkk a p√°lya elemeinek kirajzol√°s√°ban van.</p>

            <h4>A <span class="kodreszlet">rajzol√°s()</span> f√ºggv√©ny m√≥dos√≠t√°sa</h4>

            <p>A p√°lya kirajzol√°sa (minden szerepl≈ëvel egy√ºtt) a megszokott m√≥don t√∂rt√©nik, azonban a j√°t√©kos helyzet√©t≈ël f√ºgg≈ëen el kell tolnunk a p√°ly√°t a j√°t√©kt√©ren. Ennek meg√©rt√©s√©hez tekints√ºnk a j√°t√©kt√©rre (a canvas-re) egy vonat ablakak√©nt, a t√°jra pedig a p√°lyak√©nt. Utaz√°s k√∂zben a szem√ºnk el≈ëtt az ablak fix marad, csak a m√∂g√∂tte l√©v≈ë t√°j v√°ltozik. Ahogyan a t√°j az ablak m√∂g√∂tt, √∫gy fog a p√°lya is elmozdulni a canvas m√∂g√∂tt.</p>

            <p>Ez az eltol√°s jelenti minden kirajzol√°s alapj√°t, ez√©rt el≈ësz√∂r meg kell vizsg√°lnunk, hogy melyik negyedben van a j√°t√©kos. Ett≈ël f√ºgg≈ëen a <span class="kodreszlet">(0, 0)</span>, a <span class="kodreszlet">(15, 0)</span>, a <span class="kodreszlet">(0, 10)</span>, vagy a<span class="kodreszlet">(15, 10)</span> <span class="kodreszlet">x</span> √©s <span class="kodreszlet">y</span> poz√≠ci√≥kkal rendelkez≈ë mez≈ët≈ël kezd≈ëd≈ëen rajzolunk ki mindent.</p>

            <p>T√°roljuk el, hogy h√°ny mez≈ë van egy negyedben v√≠zszintesen √©s f√ºgg≈ëlegesen.</p>

            <pre>
                <code>
function rajzol√°s() {
    // h√°ny csempe van v√≠zszintesen √©s f√ºgg≈ëlegesen
    <span class="kodkiemeles">const csempesz√°mX = canvas.width / M;
    const csempesz√°mY = canvas.height / M;</span>
    ...
}
                </code>
            </pre>
            
            <p>Kezdj√ºk a <b>v√≠zszintes meghat√°roz√°ssal</b>. A <span class="kodreszlet">pacman</span> szerepl≈ë <span class="kodreszlet">x</span> poz√≠ci√≥ja ismert: <span class="kodreszlet">pacman.x</span>. Ezt osszuk el annyival, ah√°ny mez≈ë van egy negyedben v√≠zszintesen (<span class="kodreszlet">csempesz√°mX</span>). Ha a <span class="kodreszlet">pacman</span> a jobb oldali negyedek valamelyik√©ban van, vagyis az <span class="kodreszlet">x</span> poz√≠ci√≥ja legal√°bb <span class="kodreszlet">15</span>, akkor ez a h√°nyados 1-n√©l nagyobb. Ellenkez≈ë esetben egy 0 √©s 1 k√∂z√∂tti sz√°m. Ezt kerek√≠ts√ºk lefel√©, majd szorozzuk be a csemp√©k v√≠zszintes sz√°m√°val, √©s √≠gy vagy <span class="kodreszlet">0</span>-t vagy <span class="kodreszlet">15</span>-√∂t kapunk.</p>

            <p>Ugyanezt v√©gezz√ºk el <b>f√ºgg≈ëlegesen is</b>.</p>

            <pre>
                <code>
function rajzol√°s() {
    // h√°ny csempe van v√≠zszintesen √©s f√ºgg≈ëlegesen
    const csempesz√°mX = canvas.width / M;
    const csempesz√°mY = canvas.height / M;

    // negyed kezdet√©nek kisz√°mol√°sa
    <span class="kodkiemeles">let negyedKezdX = Math.floor(pacman.x / csempesz√°mX) * csempesz√°mX;
    let negyedKezdY = Math.floor(pacman.y / csempesz√°mY) * csempesz√°mY;</span>
    ...
}
                </code>
            </pre>

            <p>Rajzoljuk ki a <b>fekete h√°tteret</b>, majd <b>ments√ºk el a jelenlegi √°llapotot</b> a <span class="kodreszlet">ctx.save()</span> paranccsal.</p>

            <pre>
                <code>
function rajzol√°s() {
    // h√°ny csempe van v√≠zszintesen √©s f√ºgg≈ëlegesen
    const csempesz√°mX = canvas.width / M;
    const csempesz√°mY = canvas.height / M;

    // negyed kezdet√©nek kisz√°mol√°sa
    let negyedKezdX = Math.floor(pacman.x / csempesz√°mX) * csempesz√°mX;
    let negyedKezdY = Math.floor(pacman.y / csempesz√°mY) * csempesz√°mY;

    // h√°tt√©r
    <span class="kodkiemeles">ctx.fillStyle = 'black';
    ctx.fillRect(0, 0, canvas.width, canvas.height);</span>

    // elmentj√ºk a jelenlegi √°llapotot
    <span class="kodkiemeles">ctx.save();</span>
    ...
}
                </code>
            </pre>

            <p><b>Toljuk el</b> a canvast <b>negat√≠v ir√°nyba</b> a fentebb kisz√°molt √©rt√©kekkel: v√≠zszintesen 0 vagy 15 mez≈ënyivel (<span class="kodreszlet">negyedKezdX</span>), f√ºgg≈ëlegesen 0 vagy 10 mez≈ënyivel (<span class="kodreszlet">negyedKezdY</span>)</p>

            <pre>
                <code>
function rajzol√°s() {
    // h√°ny csempe van v√≠zszintesen √©s f√ºgg≈ëlegesen
    const csempesz√°mX = canvas.width / M;
    const csempesz√°mY = canvas.height / M;

    // negyed kezdet√©nek kisz√°mol√°sa
    let negyedKezdX = Math.floor(pacman.x / csempesz√°mX) * csempesz√°mX;
    let negyedKezdY = Math.floor(pacman.y / csempesz√°mY) * csempesz√°mY;

    // h√°tt√©r
    ctx.fillStyle = 'black';
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // elmentj√ºk a jelenlegi √°llapotot
    ctx.save();

    // canvas eltol√°sa
    <span class="kodkiemeles">ctx.translate(-negyedKezdX * M, -negyedKezdY * M);</span>
    ...
}
                </code>
            </pre>

            <p>Ezut√°n j√∂het <b>a szerepl≈ëk √©s tov√°bbi elemek szok√°sos kirajzol√°sa</b>.</p>

            <pre>
                <code>
function rajzol√°s() {
    // h√°ny csempe van v√≠zszintesen √©s f√ºgg≈ëlegesen
    const csempesz√°mX = canvas.width / M;
    const csempesz√°mY = canvas.height / M;

    // negyed kezdet√©nek kisz√°mol√°sa
    let negyedKezdX = Math.floor(pacman.x / csempesz√°mX) * csempesz√°mX;
    let negyedKezdY = Math.floor(pacman.y / csempesz√°mY) * csempesz√°mY;

    // h√°tt√©r
    ctx.fillStyle = 'black';
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // elmentj√ºk a jelenlegi √°llapotot
    ctx.save();

    // canvas eltol√°sa
    ctx.translate(-negyedKezdX * M, -negyedKezdY * M);

    <span class="kodkiemeles">// falak
    falak.forEach(fal => {
        /* ctx.fillStyle = 'brown';
        ctx.fillRect(fal.x * M, fal.y * M, fal.sz√©less√©g, fal.magass√°g); */
        ctx.drawImage(k√©pek.falk√©p, fal.x * M, fal.y * M, fal.sz√©less√©g, fal.magass√°g)
    });

    // √©rm√©k
    √©rm√©k.forEach(√©rme => {
        ctx.drawImage(k√©pek.√©rme, √©rme.x * M, √©rme.y * M, √©rme.sz√©less√©g, √©rme.magass√°g);
    });

    // extra √©rm√©k kirajzol√°sa
    extr√°k.forEach(extra => {
        ctx.drawImage(k√©pek.extra√©rme, extra.x * M, extra.y * M, extra.sz√©less√©g, extra.magass√°g);
    });

    // pacman
    if(!gy≈ëzelem && !veres√©g){
        ctx.drawImage(k√©pek.pacman, pacman.x * M, pacman.y * M, pacman.sz√©less√©g, pacman.magass√°g);
    } else if (gy≈ëzelem) {
        ctx.drawImage(k√©pek.pacman, 230, 250, pacman.sz√©less√©g * 3, pacman.magass√°g * 3);
        ctx.drawImage(k√©pek.pacman, 830, 250, pacman.sz√©less√©g * 3, pacman.magass√°g * 3);
        ctx.drawImage(k√©pek.pacman, 230, 650, pacman.sz√©less√©g * 3, pacman.magass√°g * 3);
        ctx.drawImage(k√©pek.pacman, 830, 650, pacman.sz√©less√©g * 3, pacman.magass√°g * 3);
    }

    // szellemek
    if(!gy≈ëzelem && !veres√©g && !halhatatlan){
        szellemek.forEach(szellem => {
            ctx.drawImage(k√©pek.szellemaktiv, szellem.x * M, szellem.y * M, szellem.sz√©less√©g, szellem.magass√°g);
        });
    } else if (!gy≈ëzelem && !veres√©g && halhatatlan) {
        szellemek.forEach(szellem => {
            ctx.drawImage(k√©pek.szelleminaktiv, szellem.x * M, szellem.y * M, szellem.sz√©less√©g, szellem.magass√°g);
        });
    }else if (veres√©g) {
        ctx.drawImage(k√©pek.szellemaktiv, 230, 250, M * 3, M * 3);
        ctx.drawImage(k√©pek.szellemaktiv, 830, 250, M * 3, M * 3);
        ctx.drawImage(k√©pek.szellemaktiv, 230, 650, M * 3, M * 3);
        ctx.drawImage(k√©pek.szellemaktiv, 830, 650, M * 3, M * 3);
    }

    // s√°v
    if (halhatatlan) {
        ctx.fillStyle = 'green';
        ctx.fillRect(10, 10, visszasz√°ml√°l√°s * 10, 20);
        ctx.fillRect(10, 10 * M + 10, visszasz√°ml√°l√°s * 10, 20);
        ctx.fillRect(15 * M + 10, 10, visszasz√°ml√°l√°s * 10, 20);
        ctx.fillRect(15 * M + 10, 10 * M + 10, visszasz√°ml√°l√°s * 10, 20);
    }</span>
    ...
}
                </code>
            </pre>

            <p>V√©g√ºl <b>√°ll√≠ts√ºk vissza a canvas eredeti √°llapot√°t</b> a <span class="kodreszlet">ctx.restore()</span> paranccsal √©s √≠rjuk ki a <b>nyertes</b> √©s <b>vesztes</b> sz√∂vegeket.</p>

            <pre>
                <code>
function rajzol√°s() {
    // h√°ny csempe van v√≠zszintesen √©s f√ºgg≈ëlegesen
    const csempesz√°mX = canvas.width / M;
    const csempesz√°mY = canvas.height / M;

    // negyed kezdet√©nek kisz√°mol√°sa
    let negyedKezdX = Math.floor(pacman.x / csempesz√°mX) * csempesz√°mX;
    let negyedKezdY = Math.floor(pacman.y / csempesz√°mY) * csempesz√°mY;

    // h√°tt√©r
    ctx.fillStyle = 'black';
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // elmentj√ºk a jelenlegi √°llapotot
    ctx.save();

    // canvas eltol√°sa
    ctx.translate(-negyedKezdX * M, -negyedKezdY * M);

    // falak
    falak.forEach(fal => {
        /* ctx.fillStyle = 'brown';
        ctx.fillRect(fal.x * M, fal.y * M, fal.sz√©less√©g, fal.magass√°g); */
        ctx.drawImage(k√©pek.falk√©p, fal.x * M, fal.y * M, fal.sz√©less√©g, fal.magass√°g)
    });

    // √©rm√©k
    √©rm√©k.forEach(√©rme => {
        ctx.drawImage(k√©pek.√©rme, √©rme.x * M, √©rme.y * M, √©rme.sz√©less√©g, √©rme.magass√°g);
    });

    // extra √©rm√©k kirajzol√°sa
    extr√°k.forEach(extra => {
        ctx.drawImage(k√©pek.extra√©rme, extra.x * M, extra.y * M, extra.sz√©less√©g, extra.magass√°g);
    });

    // pacman
    if(!gy≈ëzelem && !veres√©g){
        ctx.drawImage(k√©pek.pacman, pacman.x * M, pacman.y * M, pacman.sz√©less√©g, pacman.magass√°g);
    } else if (gy≈ëzelem) {
        ctx.drawImage(k√©pek.pacman, 230, 250, pacman.sz√©less√©g * 3, pacman.magass√°g * 3);
        ctx.drawImage(k√©pek.pacman, 830, 250, pacman.sz√©less√©g * 3, pacman.magass√°g * 3);
        ctx.drawImage(k√©pek.pacman, 230, 650, pacman.sz√©less√©g * 3, pacman.magass√°g * 3);
        ctx.drawImage(k√©pek.pacman, 830, 650, pacman.sz√©less√©g * 3, pacman.magass√°g * 3);
    }

    // szellemek
    if(!gy≈ëzelem && !veres√©g && !halhatatlan){
        szellemek.forEach(szellem => {
            ctx.drawImage(k√©pek.szellemaktiv, szellem.x * M, szellem.y * M, szellem.sz√©less√©g, szellem.magass√°g);
        });
    } else if (!gy≈ëzelem && !veres√©g && halhatatlan) {
        szellemek.forEach(szellem => {
            ctx.drawImage(k√©pek.szelleminaktiv, szellem.x * M, szellem.y * M, szellem.sz√©less√©g, szellem.magass√°g);
        });
    }else if (veres√©g) {
        ctx.drawImage(k√©pek.szellemaktiv, 230, 250, M * 3, M * 3);
        ctx.drawImage(k√©pek.szellemaktiv, 830, 250, M * 3, M * 3);
        ctx.drawImage(k√©pek.szellemaktiv, 230, 650, M * 3, M * 3);
        ctx.drawImage(k√©pek.szellemaktiv, 830, 650, M * 3, M * 3);
    }

    // s√°v
    if (halhatatlan) {
        ctx.fillStyle = 'green';
        ctx.fillRect(10, 10, visszasz√°ml√°l√°s * 10, 20);
        ctx.fillRect(10, 10 * M + 10, visszasz√°ml√°l√°s * 10, 20);
        ctx.fillRect(15 * M + 10, 10, visszasz√°ml√°l√°s * 10, 20);
        ctx.fillRect(15 * M + 10, 10 * M + 10, visszasz√°ml√°l√°s * 10, 20);
    }

    <span class="kodkiemeles">// eredeti √°llapotot vissza√°ll√≠t√°sa
    ctx.restore();

    // nyertes sz√∂veg
    if(gy≈ëzelem) {
        ctx.font = '80px Courier New';
        ctx.fillStyle = 'white';
        ctx.fillText('Nyert√©l', 130, 200);
        ctx.fillText('Nyert√©l', 780, 200);
        ctx.fillText('Nyert√©l', 130, 600);
        ctx.fillText('Nyert√©l', 780, 600);
    }
    // vesztes sz√∂veg
    if(veres√©g) {
        ctx.font = '80px Courier New';
        ctx.fillStyle = 'white';
        ctx.fillText('Vesztett√©l', 70, 200);
        ctx.fillText('Vesztett√©l', 740, 200);
        ctx.fillText('Vesztett√©l', 70, 600);
        ctx.fillText('Vesztett√©l', 740, 600);
    }</span>
}
                </code>
            </pre>

            <h4>Halhatatlans√°g</h4>

            <p>A k√ºl√∂nleges √©rm√©k begy≈±jt√©se <b>10 m√°sodpercnyi halhatatlans√°got</b> jelent, amikor √©rinthetj√ºk a szellemeket. Ezt t√∂bb minden jelzi a j√°t√©kban: a <b>szellemek jelmeze</b> √©s a j√°t√©k bal fels≈ë sark√°ban megjelen≈ë z√∂ld <b>s√°v</b>, ami a halhatatlans√°gb√≥l h√°tral√©v≈ë id≈ët mutatja vizu√°lisan. N√©zz√ºk meg ennek a sa√°vnak a megval√≥s√≠t√°s√°t! Ehhez kellenek a <span class="kodreszlet">halhatatlan</span> √©s a <span class="kodreszlet">visszasz√°ml√°l√°s</span> v√°ltoz√≥k. El≈ëbbi annak t√°rol√°s√°ra szolg√°l, hogy m√©g a halhatatlans√°g √°llapot√°ban vagyunk-e (logikai v√°ltoz√≥), ut√≥bbi pedig a h√°tral√©v≈ë id≈ë t√°rol√°s√°ra (val√≥s sz√°m).</p>

            <pre>
                <code>
let mozog = false;
let gy≈ëzelem = false;
let veres√©g = false;
<span class="kodkiemeles">let halhatatlan = false;
let visszasz√°ml√°l√°s = 0;</span>
                </code>
            </pre>

            <p>Halhatatlann√° az <b>extra √©rm√©k begy≈±jt√©s√©vel</b> tudunk v√°lni. Ekkor √°ll√≠tsuk be a <span class="kodreszlet">visszasz√°ml√°l√°s</span>t 10-re.</p>

            <pre>
                <code>
// √©rme begy≈±jt√©se
√©rm√©k.forEach(√©rme => {
    if(√ºtk√∂znek(√©rme, pacman)) {
        √©rm√©k.splice(√©rm√©k.indexOf(√©rme), 1);
    }
});

<span class="kodkiemeles">extr√°k.forEach(extra => {
    if(√ºtk√∂znek(extra, pacman)) {
        extr√°k.splice(extr√°k.indexOf(extra), 1);
        halhatatlan = true;
        visszasz√°ml√°l√°s = 10;
    }
});</span>
                </code>
            </pre>

            <p>Rajzoljuk ki a s√°vot <b>a h√°tral√©v≈ë id≈ë alapj√°n</b> akkor, <b>ha √©ppen halhatatlanok vagyunk</b>. Ezt <b>n√©gy</b> poz√≠ci√≥n kell megtenn√ºnk a canvas eltol√°sa miatt.</p>

            <pre>
                <code>
function rajzol√°s() {
    // szellemek
    ...

    // s√°v
    <span class="kodkiemeles">if (halhatatlan) {
        ctx.fillStyle = 'green';
        ctx.fillRect(10, 10, visszasz√°ml√°l√°s * 10, 20);
        ctx.fillRect(10, 10 * M + 10, visszasz√°ml√°l√°s * 10, 20);
        ctx.fillRect(15 * M + 10, 10, visszasz√°ml√°l√°s * 10, 20);
        ctx.fillRect(15 * M + 10, 10 * M + 10, visszasz√°ml√°l√°s * 10, 20);
    }</span>

    // eredeti √°llapotot vissza√°ll√≠t√°sa
    ...
}
                </code>
            </pre>

            <p>Ha halhatatlanok vagyunk, <b>kezd≈ëdj√∂n el a visszasz√°ml√°l√°s</b>. Ha lej√°rt az id≈ënk, <b>t√∂bb√© nem</b> vagyunk halhatatlanok.</p>

            <pre>
                <code>
function friss√≠t√©s(dt) {
    ...
    // √©rme begy≈±jt√©se
    ...

    // visszasz√°ml√°l√°s
    <span class="kodkiemeles">if (halhatatlan) {
        visszasz√°ml√°l√°s -= dt;
        console.log(visszasz√°ml√°l√°s);
    }
    if (visszasz√°ml√°l√°s &lt;= 0) {
        halhatatlan = false;
    }</span>

    // veres√©g
    ...
}
                </code>
            </pre>

            <p>A <span class="kodreszlet">halhatatlan</span> v√°ltoz√≥ √°llapota a szellemek megjelen√©s√©t is befoly√°solja.</p>

            <pre>
                <code>
// szellemek
if(!gy≈ëzelem && !veres√©g && <span class="kodkiemeles">!halhatatlan</span>){
    szellemek.forEach(szellem => {
        ctx.drawImage(k√©pek.szellemaktiv, szellem.x * M, szellem.y * M, szellem.sz√©less√©g, szellem.magass√°g);
    });
} else if (!gy≈ëzelem && !veres√©g && <span class="kodkiemeles">halhatatlan</span>) {
    szellemek.forEach(szellem => {
        ctx.drawImage(k√©pek.szelleminaktiv, szellem.x * M, szellem.y * M, szellem.sz√©less√©g, szellem.magass√°g);
    });
} else if (veres√©g) {
    ctx.drawImage(k√©pek.szellemaktiv, 230, 250, M * 3, M * 3);
    ctx.drawImage(k√©pek.szellemaktiv, 830, 250, M * 3, M * 3);
    ctx.drawImage(k√©pek.szellemaktiv, 230, 650, M * 3, M * 3);
    ctx.drawImage(k√©pek.szellemaktiv, 830, 650, M * 3, M * 3);
}
                </code>
            </pre>

            <p>Csak akkor vesz√≠ts√ºnk, ha a szellemekkel val√≥ √ºtk√∂z√©skor <b>√©ppen nem</b> voltunk halhatatlanok.</p>

            <pre>
                <code>
// veres√©g
szellemek.forEach(szellem => {
    if(√ºtk√∂znek(szellem, pacman) && <span class="kodkiemeles">!halhatatlan</span>) {
        veres√©g = true;
    }
});
                </code>
            </pre>

        </div>

    </main>

    <footer>

    </footer>
</body>
</html>